# https://taskfile.dev

version: '3'

tasks:
  test:
    desc: Runs all tests.
    cmds:
      - go test ./...
    sources:
      - ./**/*.go

  vet:
    desc: >-
      Runs vet (https://pkg.go.dev/cmd/vet), which examines Go source code and
      reports suspicious constructs.
    cmds:
      - go vet ./...
    sources:
      - ./**/*.go

  staticcheck:
    desc: >-
      Runs Staticcheck (https://staticcheck.io/), the state of the art linter
      for the Go programming language.
    cmds:
      - staticcheck -checks all ./...
    sources:
      - ./**/*.go

  goBuild:
    desc: Compiles all Go files without any preparation.
    cmds:
      - go build
    sources:
      - ./**/*.go
    generates:
      - server

  build:
    desc: >-
      Compiles all Go files to our binary "server" after copying client files
      and running tests and checks.
    deps:
      - test
      - vet
      - staticcheck
    cmds:
      - task: goBuild
